<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thử Thách - BeBet</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="/css/challenge.css">
    <link rel="stylesheet" href="/css/layout.css">
</head>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<body>

<div th:replace="layout/toastnotification.html :: toast(failed=${failed}, success=${success})"></div>

<div th:replace="layout/toastresponse.html :: toastresponse"></div>

<div th:replace="layout/sidebar.html"></div>

<!-- Page Content -->
<div id="content">
    <!-- Header -->
    <div class="row mx-0">
        <div class="col-md-12"><div th:replace="layout/userinformation.html :: user(user=${user})"></div></div>
    </div>

    <!-- Content Area -->
    <div class="content-area">
        <!-- Add Challenge Button -->
        <button class="btn add-challenge-btn">
            <i class="fas fa-plus"></i> Thêm thử thách
        </button>

        <!-- Search Bar -->
        <div class="search-container">
            <div class="search-bar">
                <input type="text" class="search-input" placeholder="Search">
                <button class="search-button">
                    <i class="fas fa-search"></i>
                </button>
            </div>
        </div>

        <!-- Challenges Section -->
        <div class="challenges-header" th:text="'Thử Thách Đang Tham Gia: ' + ${challenges.size()}">
            Thử Thách Đang Tham Gia: 4
        </div>

        <div class="challenges-grid">
            <div th:each="challenge : ${challenges}" class="challenge-card">
                <div class="challenge-name" th:text="${challenge.getChallenge().getTitle()}">Chơi Thể Thao</div>
                <div class="challenge-description" th:text="${challenge.getChallenge().getDescription()}">
                    Mô tả: Duy trì chơi thể thao thay đổi hình thể
                </div>
                <div class="challenge-progress">
                    <span class="progress-text" th:text="'Ngày thực hiện: ' + ${challenge.getDaysSinceStart()} + '/' + ${challenge.getChallenge().getDay()}">
                        Ngày thực hiện: 20/50
                    </span>
                </div>
                <div class="streak-info">
                    <span th:text="'Chuỗi liên tiếp: ' + ${challenge.streak}">Chuỗi liên tiếp: 16</span><i class="fas fa-fire"></i>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Add challenge button click
        const addChallengeBtn = document.querySelector('.add-challenge-btn');
        if (addChallengeBtn) {
            addChallengeBtn.addEventListener('click', function () {
                alert('Thêm thử thách mới');
            });
        }

        // Search functionality
        const searchInput = document.querySelector('.search-input');
        if (searchInput) {
            searchInput.addEventListener('keyup', function () {
                const searchTerm = searchInput.value.toLowerCase();
                const challengeCards = document.querySelectorAll('.challenge-card');

                challengeCards.forEach(function (card) {
                    const challengeNameElem = card.querySelector('.challenge-name');
                    const challengeName = challengeNameElem ? challengeNameElem.textContent.toLowerCase() : "";

                    if (challengeName.includes(searchTerm)) {
                        card.style.display = '';
                    } else {
                        card.style.display = 'none';
                    }
                });
            });
        }

        // Challenge card click
        const challengeCards = document.querySelectorAll('.challenge-card');
        challengeCards.forEach(function (card) {
            card.addEventListener('click', function () {
                const challengeNameElem = card.querySelector('.challenge-name');
                const challengeName = challengeNameElem ? challengeNameElem.textContent : "Không rõ";
                console.log('Clicked on challenge:', challengeName);
            });
        });
    });

</script>
</body>
</html>
